DirectorySlash Off
Options -Indexes

RewriteEngine On
#ErrorDocument 403 /error/http?code=403
#ErrorDocument 404 /error/http?code=404
#ErrorDocument 500 /error/http?code=500

#block access to conf.ini
RewriteRule ^conf.ini$ - [F]
RewriteRule ^data/mg.log$ - [F]
RewriteRule ^data/anons.json$ - [F]
RewriteRule ^data/mirror$ - [F]
RewriteRule ^data/cache$ - [F]

RewriteRule ^/?$ /s/index [QSA,L]
RewriteRule ^/?s/(.*) /dispatch.php?request=index/$1 [QSA,L]
RewriteRule ^/?a/(.*) /dispatch.php?request=admin/$1 [QSA,L]

RewriteRule ^/?([=,0-9a-zA-Z_-]{3,})/?$ $1/profile [L]
RewriteRule ^/?([=,0-9a-zA-Z_-]{3,})/?(profile|list|achi|rati|acti|favs|misc|sug)(,(anime|manga))?/?$ /dispatch.php?request=stats/$2&u=$1&am=$4 [QSA,L]
RewriteRule ^/?export/([=0-9a-zA-Z_-]{3,})/?$ /dispatch.php?request=stats/rati-img&u=$1&am=$4 [QSA,L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^/?(.*)$ /dispatch.php?request=$1 [QSA,B,L]
