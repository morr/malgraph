<div class="section">
	<h2>
		<a href="<?php echo $this->mgHelper->constructUrl(null, null, [], $this->user['link-name']) ?>">
			<?php echo $this->user['visible-name'] ?>
		</a>
		`s <?php echo $this->mgHelper->amText() ?> list
	</h2>

	<div class="section-body">
		<?php if (empty($this->user[$this->am]['entries'])): ?>
			<p>This user doesn't seem to have anything on their list.</p>
		<?php elseif ($this->user[$this->am]['private']): ?>
			<p>This user has marked their list as private. No table here.</p>
		<?php else: ?>
			<div class="table">
				<table>
					<thead>
						<tr>
							<th class="ord">#</th>

							<th class="status">
								<a class="tooltipable"
									data-title="Status"
									data-position-my="center bottom"
									data-position-at="center top"
									href="<?php echo $this->mgHelper->constructUrl(null, null, ['sort-column' => 'status', 'sort-dir' => $this->view->sortColumn == 'status' ? 1 - $this->view->sortDir : 0]) ?>">
									S
								</a>
							</th>

							<?php if (count($this->view->users) > 1): ?>
								<th class="unique">
									<a class="tooltip tooltipable"
										data-title="Unique - marked with &bdquo;+&rdquo; if only this user has given title in their list."
										data-position-my="center bottom"
										data-position-at="center top"
										href="<?php echo $this->mgHelper->constructUrl(null, null, ['sort-column' => 'unique', 'sort-dir' => $this->view->sortColumn == 'unique' ? 1 - $this->view->sortDir : 0]) ?>">
										U
									</a>
								</th>
							<?php endif ?>

							<th class="title">
								<a href="<?php echo $this->mgHelper->constructUrl(null, null, ['sort-column' => 'score', 'sort-dir' => $this->view->sortColumn == 'score' ? 1 - $this->view->sortDir : 0]) ?>">
									Title
								</a>
							</th>

							<th class="score">
								<a href="<?php echo $this->mgHelper->constructUrl(null, null, ['sort-column' => 'score', 'sort-dir' => $this->view->sortColumn == 'score' ? 1 - $this->view->sortDir : 0]) ?>">
									Score
								</a>
							</th>
						</tr>
					</thead>

					<tbody>
						<?php $k = 1 ?>
						<?php foreach ($this->user[$this->am]['entries'] as $e): ?>
							<?php if ($e['user']['unique']): ?>
								<tr class="unique">
							<?php else: ?>
								<tr>
							<?php endif ?>
								<td class="ord"><?php echo $k ++ ?></td>

								<td class="status">
									<i
									<?php if ($e['user']['status'] == UserModel::USER_LIST_STATUS_PLANNED): ?>
										data-title="Planned" class="icon-schedule tooltipable"
									<?php elseif ($e['user']['status'] == UserModel::USER_LIST_STATUS_DROPPED): ?>
										data-title="Dropped" class="icon-cross tooltipable"
									<?php elseif ($e['user']['status'] == UserModel::USER_LIST_STATUS_WATCHING): ?>
										data-title="Watching" class="icon-eye tooltipable"
									<?php elseif ($e['user']['status'] == UserModel::USER_LIST_STATUS_ONHOLD): ?>
										data-title="On-hold" class="icon-hourglass tooltipable"
									<?php elseif ($e['user']['status'] == UserModel::USER_LIST_STATUS_COMPLETED): ?>
										data-title="Completed" class="icon-tick tooltipable"
									<?php endif ?>
									></i>
								</td>

								<?php if (count($this->view->users) > 1): ?>
									<td class="unique">
										<?php if ($e['user']['unique']): ?>
											<i data-title="Only this user has this title on his list" class="tooltipable icon-plus"></i>
										<?php else: ?>
											<i data-title="Both users have this title on their lists" class="tooltipable icon-dot"></i>
										<?php endif ?>
									</td>
								<?php endif ?>

								<td class="title">
									<a href="http://myanimelist.net/<?php echo $this->view->mgHelper->amText() ?>/<?php echo $e['full']['id'] ?>">
										<?php echo $e['full']['title'] ?>
									</a>
								</td>

								<?php if (!empty($e['others']) and count($e['others']) == 1): ?>
									<?php $e2 = reset($e['others']) ?>
									<?php if ($e['user']['score'] > $e2['user']['score']): ?>
										<?php if ($e2['user']['score'] > 0): ?>
											<td class="score higher-score">
												<span class="tooltipable" data-title="This title was rated lower by the other user.">
										<?php else: ?>
											<td class="score no-score">
												<span class="tooltipable" data-title="This title wasn't rated by the other user.">
										<?php endif ?>
									<?php elseif ($e['user']['score'] < $e2['user']['score']): ?>
										<?php if ($e['user']['score'] > 0): ?>
											<td class="score lower-score">
												<span class="tooltipable" data-title="This title was rated higher by the other user.">
										<?php else: ?>
											<td class="score no-score">
												<span class="tooltipable" data-title="This title wasn't rated by this user.">
										<?php endif ?>
									<?php else: ?>
										<?php if ($e['user']['score'] > 0): ?>
											<td class="score same-score">
												<span class="tooltipable" data-title="Both users rated this title equally.">
										<?php else: ?>
											<td class="score no-score">
												<span class="tooltipable" data-title="None of users rated this title.">
										<?php endif ?>
									<?php endif ?>
								<?php else: ?>
									<td class="score">
										<span>
								<?php endif ?>
									<?php if (empty($e['user']['score'])): ?>
										-
									<?php else: ?>
										<?php echo $e['user']['score'] ?>
									<?php endif ?>
									</span>
								</td>
							</tr>
						<?php endforeach ?>
					</tbody>

				</table>
			</div>
		<?php endif ?>

	</div>
</div>
